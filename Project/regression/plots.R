library(ggplot2)
library(knitr)

weights <- c(-0.0155673547965, -0.032512577208, -0.0183928993822, 0.0436023817917, -0.168735260358, -0.0548502431781, 0.0400864539071, 0.0477745936425, 0.0482044874247, 0.656851318914, 0.101863103466, 0.0787925572846, 0.0772113800894, -0.109357780179, 0.00259863923261, 0.253263211162, 0.00423288154355, -0.151785209635, -0.086932735094, 0.0642537764487, 0.0594296289471, -0.0784431104261, 0.0100914683538, -0.0455614111585, -0.150498327579, 0.0370920476908, -0.471571091079, 0.00575529953804, -0.174645309934, -0.00122143569646, -0.120772053981, 0.729336915393, 0.0191174119751, -0.0296600316436, 0.0414784388088, 0.192408869835, 0.0525969201364, -0.0430805415879, -0.179258076024, -0.13951006772, 0.0400864539072, -0.199291009302, 0.125170423372, -0.00107423696482, 0.1722575493, -0.103366129896, -0.0142565167554, -0.0481040689734, -0.277144753309, -0.00275229839806, 0.123937726235, 0.111792685733, 0.261123875719, -0.0202035470324, -0.0667582303632, 0.0161341447383, -0.214593015947, 0.0525950326542, 0.0457459855028, 0.0809072398456, 0.0841238574083, -0.0947854358489, -0.0536801646975, -0.105109365666, -0.553358112213, -0.00518030191328, -0.00801186882178, 0.026662047528, -0.0707252848644, -0.00164194215674, -0.00696646258888, -0.0156368327091, -0.243055275894, -0.0265795567348, 0.0236131786527, 0.126044421422, 0.0661457097531, -0.110683337504, 0.0679989404147, 0.167213483369, -0.0287554883533, 0.0611867349866, -0.0321046144057, -0.255398058467, -0.290623015012, 0.0022774254305, -0.0126711530544, -0.0831671026105, -0.0064248106726, -0.170417879777, 9.04696649847)
names <- c("author_gender_ambiguous / unknown", "author_gender_female", "desk_Arts&Leisure", "desk_Automobiles", "desk_BookReview", "desk_Culture", "desk_Dining", "desk_EdLife", "desk_Editorial", "desk_Foreign", "desk_Home", "desk_Letters", "desk_Magazine", "desk_Metro", "desk_NODESK", "desk_National", "desk_NewsDesk", "desk_None", "desk_OpEd", "desk_RealEstate", "desk_Science", "desk_Society", "desk_Sports", "desk_Styles", "desk_Summary", "desk_SundayBusiness", "desk_Travel", "desk_Washington", "desk_Weekend", "flesch-kincaid_score", "log_popularity", "log_wcount", "perplexity", "section_Automobiles", "section_Blogs", "section_Books", "section_Booming", "section_Business Day", "section_Corrections", "section_Crosswords & Games", "section_Dining & Wine", "section_Education", "section_Fashion & Style", "section_Great Homes and Destinations", "section_Health", "section_Home & Garden", "section_Job Market", "section_Magazine", "section_Movies", "section_Multimedia", "section_Multimedia/Photos", "section_N.Y. / Region", "section_Opinion", "section_Public Editor", "section_Real Estate", "section_Science", "section_Sports", "section_Style", "section_Sunday Review", "section_T Magazine", "section_Technology", "section_Theater", "section_Travel", "section_U.S.", "section_World", "section_Your Money", "typeOfMaterial_An Appraisal", "typeOfMaterial_Biography", "typeOfMaterial_Brief", "typeOfMaterial_Correction", "typeOfMaterial_Economic Analysis", "typeOfMaterial_Editorial", "typeOfMaterial_Letter", "typeOfMaterial_List", "typeOfMaterial_Military Analysis", "typeOfMaterial_News", "typeOfMaterial_News Analysis", "typeOfMaterial_Obituary", "typeOfMaterial_Obituary (Obit)", "typeOfMaterial_Op-Ed", "typeOfMaterial_Question", "typeOfMaterial_Quote", "typeOfMaterial_Recipe", "typeOfMaterial_Review", "typeOfMaterial_Schedule", "typeOfMaterial_Series", "typeOfMaterial_Summary", "typeOfMaterial_Text", "typeOfMaterial_Web Log", "type_BlogPost", "intercept")

linear_regression_weights = data.frame(weights = weights, names = names)

ggplot(filter(linear_regression_weights, names!='intercept'), aes(x=names, y=weights)) + 
  geom_bar(stat="identity", position="dodge") + theme(axis.text.x=element_text(angle=90)) + 
  xlab('Feature') + ylab('Feature Weight')

filter(linear_regression_weights, names!='intercept') %>%
  kable(., format='latex')